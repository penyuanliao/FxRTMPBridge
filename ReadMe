
// -------------------------- //

#1 第一次要執行npm install
#2 sh startup.sh

// -------------------------- //

```shell script
# config.js 設定檔案


```


// ------ 以下是紀錄 ------ //

# basicHeader 第一個字節 fmt(2b)

    + fmt -> readUInt8(0) >> 6; ex: 12.. .... 位移 6 取值
    (1) fmt = 0, header length = 11
    (2) fmt = 1, header length = 7
    (3) fmt = 2, header length = 3
    (4) fmt = 3, header length = 0

# basicHeader 第一個字節 csid(chunk stream ID)(6b)

    + csid -> readUInt8(0) & (0x3f) ex: ..34 5678 mode 0x3f 最大值
    (1) csid = 0,1,2,3,4

# Header

## ChannelID

#1 RTMPClient.prototype.onData


amf0Encode -> amf0EncodeOne -> amfXEncodeOne

handshake::onResponse >




```script
+--------------+					+--------------+
| Client(Node) | 					| Server (FMS) |
+--------------+ 					+--------------+
	   |                                                    |
	   |                      C0 + C1                       |
	   |------------------------------------------------->  + handshake start
	   |                                                    |
	   |                    C0 + C1 + S2                    |
	   |  <-------------------------------------------------|
	   |                                                    |
	   |                         C2                         |
	   |------------------------------------------------->  + handshake ended
	   |                                                    |
	   |                 connect('rtmp server')             |
	   |------------------------------------------------->  |
	   |                                                    |
	   |         Window Acknowledgement Size 2500000        |
	   |  <-------------------------------------------------|
	   |                                                    |
	   |            Set Peer Bandwidth 25000000             |
	   |  <-------------------------------------------------|
	   |                                                    |
	   |                  Set Chunk Size 4096               |
	   |  <-------------------------------------------------|
	   |                                                    |
	   |       _result('NetConnection.Connect.Success')     |
	   +  <-------------------------------------------------| connect complete
	   |                                                    |
	   |        Windows Acknowledgement Size 2500000        |
	   |------------------------------------------------->  + #ACK-1 Start Record
	   |                                                    |
	   |                    createStream()                  |
	   |------------------------------------------------->  |
	   |                                                    |
	   |                      _result(1)                    |
	   +  <-------------------------------------------------| createStream complete
	   |                                                    |
	   |                      play(name)                    |
	   |------------------------------------------------->  |
	   |                                                    |
	   |                  Set Chunk Size 4096               |
	   |  <-------------------------------------------------|
	   |                                                    |
	   |                     Stream Begin 1                 |
	   +  <-------------------------------------------------| StreamID=1
	   |                                                    |
	   |           onStatus('NetStream.Play.Reset')         |
	   |  <-------------------------------------------------|
	   |                                                    |
	   |           onStatus('NetStream.Play.Start')         |
	   |  <-------------------------------------------------|
	   |                                                    |
	   |                |RtmpSampleAccess()                 |
	   |  <-------------------------------------------------|
	   |                                                    |
	   |                    onMetaData()                    |
	   +  <-------------------------------------------------+ Video Start
	   |                                                    |
	   |                     Video Data                     |
	   |  <-------------------------------------------------|
	   |                                                    |
	   |                     Video Data                     |
	   |  <-------------------------------------------------|
	   |                                                    |
	   |           Acknowledgement 1250123                  |
	   |------------------------------------------------->  + #ACK-2 Report
	   |                                                    |
	   |             Acknowledgement 2500123  		   		|
	   |------------------------------------------------->  + #ACK-3 Clinet total Chunk body Size >
	   |                                                    |
	   |                    Ping Request                    |
	   |  <-------------------------------------------------|
	   |                                                    |
	   |                    Ping Response                   |
	   |------------------------------------------------->  + Ping event
	   |                                                    |
	   |                  deleteStream()                    |
	   |------------------------------------------------->  + stop

```



# Video Data Info
+----------+------------+
|  Header  |    Data    |
+----------+------------+
| 12-Bytes |   ~remain  |
+----------+------------+
    (1) Header
+---+----+---------+--------+---------+--------+
|fmt|csid|timestamp|bodySize|msgTypeID|StreamID|
+--------+---------+--------+---------+--------+
| 1B     | 3B      | 3B     | 1B      | 4B     |
+--------+---------+--------+---------+--------+
    (2) Body
+------+--------+-----------+
| type | Format | videoData |
+------+--------+-----------+
| 4b   | 4b     |  ~remain  |
+------+--------+-----------+

# Ping Request

# Ping Response

# Invoke Command
+-----+------+-----------+----------+--------+-----------+--------+
| fmt | csid | timestamp | bodySize | typeid | stream id |  body  |
+-----+------+-----------+----------+--------+-----------+--------+
|  2b |  6b  |     3B    |    3B    |   1B   |     3B    |        |
+-----+------+-----------+----------+--------+-----------+--------+
    (1) Body
     > Command-Name(AMF-String)
     > Transaction-Id(AMF-Number)
     > Command-Object(AMF-Object or AMF-Null)
     > InvokeArguments(AMF-ALL)
#