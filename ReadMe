
// -------------------------- //

#1 第一次要執行npm install
#2 sh startup.sh

// -------------------------- //

```
# config.js 設定檔案


```


// ------ 以下是紀錄 ------ //

分析RTMP紀錄
第一個字節決定消息類型
## HeaderType(fmt): 決定chunk message header編碼方式和大小,前兩個2bits 決定chunk message header length
00 12 bytes 0x000000
01 8 bytes 0x
10 4 bytes
11 1 bytes
[1 2 4 8 16 32 64 128]

## ChannelID

#1 RTMPClient.prototype.onData


amf0Encode -> amf0EncodeOne -> amfXEncodeOne

handshake::onResponse >


CreateStream();

```
+--------------+									+--------------+
| Client(Node) | 									| Server (FMS) |
+--------------+ 									+--------------+
	   |                                                    |
	   |                      C0 + C1                       |
	   |------------------------------------------------->  + handshake start
	   |                                                    |
	   |                    C0 + C1 + S2                    |
	   |  <-------------------------------------------------|
	   |                                                    |
	   |                         C2                         |
	   |------------------------------------------------->  + handshake ended
	   |                                                    |
	   |                 connect('rtmp server')             |
	   |------------------------------------------------->  |
	   |                                                    |
	   |         Window Acknowledgement Size 2500000        |
	   |  <-------------------------------------------------|
	   |                                                    |
	   |            Set Peer Bandwidth 25000000             |
	   |  <-------------------------------------------------|
	   |                                                    |
	   |                  Set Chunk Size 4096               |
	   |  <-------------------------------------------------|
	   |                                                    |
	   |       _result('NetConnection.Connect.Success')     |
	   +  <-------------------------------------------------| connect complete
	   |                                                    |
	   |        Windows Acknowledgement Size 2500000        |
	   |------------------------------------------------->  + #ACK-1 Start Record
	   |                                                    |
	   |                    createStream()                  |
	   |------------------------------------------------->  |
	   |                                                    |
	   |                      _result(1)                    |
	   +  <-------------------------------------------------| createStream complete
	   |                                                    |
	   |                      play(name)                    |
	   |------------------------------------------------->  |
	   |                                                    |
	   |                  Set Chunk Size 4096               |
	   |  <-------------------------------------------------|
	   |                                                    |
	   |                     Stream Begin 1                 |
	   +  <-------------------------------------------------| StreamID=1
	   |                                                    |
	   |           onStatus('NetStream.Play.Reset')         |
	   |  <-------------------------------------------------|
	   |                                                    |
	   |           onStatus('NetStream.Play.Start')         |
	   |  <-------------------------------------------------|
	   |                                                    |
	   |                |RtmpSampleAccess()                 |
	   |  <-------------------------------------------------|
	   |                                                    |
	   |                    onMetaData()                    |
	   +  <-------------------------------------------------+ Video Start
	   |                                                    |
	   |                     Video Data                     |
	   |  <-------------------------------------------------|
	   |                                                    |
	   |                     Video Data                     |
	   |  <-------------------------------------------------|
	   |                                                    |
	   |           Acknowledgement 1250123                  |
	   |------------------------------------------------->  + #ACK-2 Report
	   |                                                    |
	   |             Acknowledgement 2500123  		   		|
	   |------------------------------------------------->  + #ACK-3 Clinet total Chunk body Size >
	   |                                                    |
	   |                    Ping Request                    |
	   |  <-------------------------------------------------|
	   |                                                    |
	   |                    Ping Response                   |
	   |------------------------------------------------->  + Ping event
	   |                                                    |
	   |                  deleteStream()                    |
	   |------------------------------------------------->  + stop

```



# Video Data Info
+----------+------------+
|  Header  |    Data    |
+----------+------------+
| 12-Bytes |   ~remain  |
+----------+------------+
    (1) Header
+---+----+---------+--------+---------+--------+
|fmt|csid|timestamp|bodySize|msgTypeID|StreamID|
+--------+---------+--------+---------+--------+
| 1B     | 3B      | 3B     | 1B      | 4B     |
+--------+---------+--------+---------+--------+
    (2) Body
+------+--------+-----------+
| type | Format | videoData |
+------+--------+-----------+
| 4b   | 4b     |  ~remain  |
+------+--------+-----------+
